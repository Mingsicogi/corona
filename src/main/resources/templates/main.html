<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: header">



    <title>CORONA-19 Dashboard</title>
</head>
<body>
    <div th:replace="fragments/bodyHeader :: bodyHeader"></div>

    <div class="x_panel">
        <div class="x_title"><h2>aaaaaaaaaa</h2></div>
        <div class="x_content" id="map" style="width: 100%; height: 100%"></div>
    </div>

    <div th:replace="fragments/footer :: footer"></div>

    <script>
        $(document).ready(function () {
            getLocation();
        });

        const x = document.getElementById("map");

        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition);
            } else {
                x.innerHTML = "Geolocation is not supported by this browser.";
            }
        }

        function showPosition(position) {
            const mapOptions = {
                center: new naver.maps.LatLng(position.coords.latitude, position.coords.longitude),
                zoom: 3,
                minZoom: 1,
                maxZoom: 13,
                // mapTypeId: naver.maps.MapTypeId.HYBRID,
                zoomControl: true,
                zoomControlOptions: {
                    position: naver.maps.Position.TOP_RIGHT
                },
                disableKineticPan: false
            };

            const map = new naver.maps.Map('map', mapOptions);

            map.setOptions({
                mapTypeControl: true,
                scaleControl: false,
                logoControl: false
            });

            const infecteeInfoList = JSON.parse(JSON.stringify(${infecteeInfoJsonStr}));

            let markingData = [];

            console.log(infecteeInfoList);
            for(let i = 0; i < infecteeInfoList.length; i++) {
                const location = infecteeInfoList[i].location;

                for(let j = 0; j < location.length; j++) {
                    markingData.push(new naver.maps.LatLng(location[j].y, location[j].x));
                }

                console.log(infecteeInfoList[i].howManyPeopleMeet);
                const dotmap = new naver.maps.visualization.DotMap({
                    map: map,
                    data: markingData,
                    radius: infecteeInfoList[i].howManyPeopleMeet/5,
                    fillColor: infecteeInfoList[i].markingColor
                });

                markingData = [];
            }

            // console.log(markingData);
            // var dotmap = new naver.maps.visualization.DotMap({
            // 	map: map,
            // 	data: markingData,
            // 	radius: 30
            // });
        }
    </script>
</body>
</html>